---
import '@splidejs/splide/css';
import { WorkItem } from 'src/porfrolio.works';
import CvSkills     from 'src/components/cvSkills.astro';
const { className = 'splide', data = []} = Astro.props as {
    data: WorkItem
}

function modifyImage(str, mode) {
    return str.replace("/upload/", `/upload/${mode}/`);
}
---

<script>
    import Splide from '@splidejs/splide';
    import { URLHash } from '@splidejs/splide-extension-url-hash';

    const splide = new Splide( '.splide', {
        width: '100%',
        height: '100%',
        type   : 'fade',
        perPage: 1,
        paginationKeyboard: true,
        interval: 2000,
        speed: 1000,
        keyboard: true,
        arrows: false,
        lazyLoad: 'nearby',
        wheel    : true,
    });

    splide.on( 'pagination:mounted', function ( data ) {
        data.list.classList.add( 'splide__pagination--custom' );

        data.items.forEach( function ( item ) {
            item.button.textContent = String( item.page + 1 );
        } );
    } );

    splide.mount({
        URLHash
    });
</script>
<div class={className} aria-label="Splide Basic HTML Example">
    <div class="splide__track">
        <ul class="splide__list">
            { data.map((slide, index) =>
                    <li class="splide__slide" data-splide-hash={`slide${index}`}>
                        <img src={modifyImage(slide.poster, 'f_auto,w_1000,h_500,c_scale/')}
                             title={slide.title}
                             class="mb-5 border-rd"
                        >
                        <div class="splide__content text-lg max-w-4xl bg-dark/80 color-white/90 border-rd p-3">
                            <div class="text-3xl mb-3">{ slide.title }</div>
                            <CvSkills data={slide.tags}/>
                            { slide.bio }
                            <br>
                            <br>
                            <a class="text-2xl badge" rel="noreferrer noopener" target="_blank" href={slide.url}>Website</a>
                        </div>
                    </li>

            )}
        </ul>
    </div>
</div>